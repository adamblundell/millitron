<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Millitron Production Entry</title>
<style>
  body { font-family: sans-serif; background:#f5f5f5; padding:20px; }
  h2 { text-align:center; }
  form { max-width:500px; margin:auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1);}
  label { display:block; margin-top:15px; }
  input, button { width:100%; padding:10px; margin-top:5px; font-size:16px; }
  button { background:#007bff; color:#fff; border:none; border-radius:4px; cursor:pointer; margin-top:20px;}
  button:hover { background:#0056b3; }
  .photos-preview { display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
  .photos-preview img { max-width:100px; max-height:100px; border:1px solid #ccc; border-radius:4px; }
</style>
</head>
<body>

<h2>Millitron Production Entr via google scriptsy</h2>

<form id="prodForm">
  <label>Production Order:</label>
  <input type="text" name="production_order" required>

  <label>DR Number:</label>
  <input type="text" name="dr_number" required>

  <label>Photo 1 (required):</label>
  <input type="file" name="attachment1" accept="image/*" capture required>

  <label>Photo 2:</label>
  <input type="file" name="attachment2" accept="image/*" capture>

  <label>Photo 3:</label>
  <input type="file" name="attachment3" accept="image/*" capture>

  <div class="photos-preview" id="photoPreview"></div>

  <button type="submit">Submit</button>
</form>

<script>
const form = document.getElementById('prodForm');
const previewContainer = document.getElementById('photoPreview');

const photoInputs = ['attachment1','attachment2','attachment3'];
photoInputs.forEach(id => {
  const input = document.querySelector(`input[name="${id}"]`);
  input.addEventListener('change', () => {
    previewContainer.innerHTML = '';
    photoInputs.forEach(pid => {
      const f = document.querySelector(`input[name="${pid}"]`).files[0];
      if(f){
        const img = document.createElement('img');
        img.src = URL.createObjectURL(f);
        previewContainer.appendChild(img);
      }
    });
  });
});

form.addEventListener('submit', async e => {
  e.preventDefault();
  const formData = new FormData(form);

  try {
    const response = await fetch('https://script.google.com/macros/s/AKfycbzo6tn4KsNcq-7cPkqpk0ia6XvdSGqilqkda05Ru1pPdaqWJFDLaxjzgUP_f5cHYFg2VA/exec', {
      method: 'POST',
      body: formData
    });
    const result = await response.json();
    if(result.status === 'success'){
      alert('Submission successful!');
      form.reset();
      previewContainer.innerHTML = '';
    } else {
      alert('Error: ' + result.message);
    }
  } catch(err){
    alert('Submission failed: ' + err.message);
  }
});
</script>

</body>
</html>

